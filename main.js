(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,i){for(var r=0;r<i.length;r++){var o=i[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,n=function(e,i){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(n)?n:String(n)),o)}var n}var i=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctx=e,this._box=i,this.position=null}var i,r;return i=t,(r=[{key:"init",value:function(){this.position={x:Math.floor(15*Math.random())*this._box,y:Math.floor(15*Math.random())*this._box}}},{key:"render",value:function(){this._ctx.beginPath();var t=this.position.x+this._box/2,e=this.position.y+this._box/2,i=this._box/3,r=2*Math.PI;this._ctx.fillStyle="#ca354a",this._ctx.arc(t,e,i,0,r),this._ctx.fill()}}])&&e(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,n=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(n)?n:String(n)),o)}var n}var n=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctx=e,this._map=i}var e,i;return e=t,(i=[{key:"render",value:function(){this._ctx.fillStyle="#2e3146",this._ctx.fillRect(0,0,this._map,this._map)}}])&&o(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==s(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var u=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctx=e,this._box=i,this.body=[],this._headColor="#05925f",this._bodyColor="#38b085",this.createHead()}var e,i;return e=t,(i=[{key:"reset",value:function(){this.body=[],this.createHead()}},{key:"createHead",value:function(){this.body[0]={x:7*this._box,y:7*this._box}}},{key:"render",value:function(){var t=this;this.body.forEach((function(e,i){t._ctx.beginPath(),t._ctx.strokeStyle=0===i?t._headColor:t._bodyColor,t._ctx.fillStyle=0===i?t._headColor:t._bodyColor,t._ctx.roundRect(e.x,e.y,t._box,t._box,8),t._ctx.stroke(),t._ctx.fill()}))}},{key:"moveTail",value:function(){this.body.pop()}},{key:"moveHead",value:function(t){this.body.unshift(t)}}])&&a(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(".js-popup-pause"),this._box=e,this._dir=null,this._newDir=null,this._direction={r:"right",l:"left",u:"up",d:"down"},this.isPause=!1,this._isGameOver=!1,document.addEventListener("keydown",this._eventHandler.bind(this))}var e,i;return e=t,(i=[{key:"_eventHandler",value:function(t){32===t.keyCode&&this._pause(),65===t.keyCode&&(this._newDir=this._direction.l),87===t.keyCode&&(this._newDir=this._direction.u),68===t.keyCode&&(this._newDir=this._direction.r),83===t.keyCode&&(this._newDir=this._direction.d)}},{key:"_pause",value:function(){this._isGameOver||(this.isPause=!this.isPause,this.isPause?this._popup.classList.add("_visible"):this._popup.classList.remove("_visible"))}},{key:"reset",value:function(){this._dir=null,this._newDir=null,this._isGameOver=!1}},{key:"checkDir",value:function(){null===this._dir&&(this._dir=this._newDir),this._dir===this._direction.u&&this._newDir!==this._direction.d&&(this._dir=this._newDir),this._dir===this._direction.d&&this._newDir!==this._direction.u&&(this._dir=this._newDir),this._dir===this._direction.r&&this._newDir!==this._direction.l&&(this._dir=this._newDir),this._dir===this._direction.l&&this._newDir!==this._direction.r&&(this._dir=this._newDir)}},{key:"eatTail",value:function(t,e){var i=!1;return e.forEach((function(e){t.x===e.x&&t.y===e.y&&(i=!0)})),this._isGameOver=i,this._isGameOver}},{key:"move",value:function(t){var e=this._box;return this._dir===this._direction.d&&(t.y+=e),this._dir===this._direction.u&&(t.y-=e),this._dir===this._direction.l&&(t.x-=e),this._dir===this._direction.r&&(t.x+=e),t}},{key:"borderMode",value:function(t){if(t.x<1*this._box||t.x>13*this._box||t.y<1*this._box||t.y>13*this._box)return this._isGameOver=!0,this._isGameOver}},{key:"freeMode",value:function(t){return t.x<1*this._box&&this._dir===this._direction.l&&(t.x=15*this._box),t.x>13*this._box&&this._dir===this._direction.r&&(t.x=-1*this._box),t.y<1*this._box&&this._dir===this._direction.u&&(t.y=15*this._box),t.y>13*this._box&&this._dir===this._direction.d&&(t.y=-1*this._box),t}}])&&l(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==f(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===f(o)?o:String(o)),r)}var o}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scoreElement=document.querySelector(".js-score"),this.score=0,this._create()}var e,i;return e=t,(i=[{key:"_create",value:function(){this.scoreElement.textContent=this.score}},{key:"reset",value:function(){this.score=0,this._create()}},{key:"add",value:function(){this.score++,this._create()}}])&&y(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function v(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==d(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===d(o)?o:String(o)),r)}var o}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rads=document.getElementsByName("borders")}var e,i;return e=t,(i=[{key:"_checkBorders",value:function(){this.rads.forEach((function(t){t.checked&&console.log(t.value)}))}},{key:"_addEventListener",value:function(){var t=this;this.form.addEventListener("submit",(function(e){e.preventDefault(),t._checkBorders()}))}}])&&v(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function _(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==m(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===m(o)?o:String(o)),r)}var o}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.btnRestart=document.querySelector(".js-restart"),this.popup=document.querySelector(".js-popup-game-over"),this.canvas=document.querySelector(".js-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.game=null,this.box=32,this.map=480,this.canvas.width=this.map,this.canvas.height=this.map,this.food=new i(this.ctx,this.box),this.ground=new n(this.ctx,this.map),this.snake=new u(this.ctx,this.box),this.logic=new h(this.box),this.score=new b(this.game),this.params=new p,this.food.init(),this._addListeners(),this._runGame())}var e,r;return e=t,(r=[{key:"_addListeners",value:function(){this.btnRestart.addEventListener("click",this._restartGame.bind(this))}},{key:"_restartGame",value:function(){this.popup.classList.remove("_visible"),this.score.reset(),this.snake.reset(),this.logic.reset(),this._runGame()}},{key:"_drawGame",value:function(){if(this.ctx.clearRect(0,0,this.map,this.map),this.ground.render(),this.food.render(),this.snake.render(),!this.logic.isPause){var t={x:this.snake.body[0].x,y:this.snake.body[0].y};t.x===this.food.position.x&&t.y===this.food.position.y?(this.score.add(),this.food.init()):this.snake.moveTail(),this.logic.checkDir(),t=this.logic.freeMode(t),t=this.logic.move(t),this.logic.eatTail(t,this.snake.body)&&this._stopGame(),this.snake.moveHead(t)}}},{key:"_stopGame",value:function(){clearInterval(this.game),this.popup.classList.add("_visible")}},{key:"_runGame",value:function(){this.game=setInterval(this._drawGame.bind(this),100)}}])&&_(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}())})();